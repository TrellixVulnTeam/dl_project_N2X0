# 新闻文本分类

## 长文本样本量
train=
{
    "科技": 35000,
    "游戏": 17061,
    "体育": 35000,
    "星座": 2504,
    "时政": 35000,
    "教育": 29355,
    "时尚": 9357,
    "彩票": 5311,
    "家居": 22810,
    "房产": 14035,
    "股票": 35000,
    "娱乐": 35000,
    "社会": 35000,
    "财经": 25968
}

eval=
{
    "科技": 10000,
    "游戏": 4874,
    "体育": 10000,
    "星座": 716,
    "时政": 10000,
    "教育": 8387,
    "时尚": 2674,
    "彩票": 1518,
    "家居": 6517,
    "房产": 4010,
    "股票": 10000,
    "娱乐": 10000,
    "社会": 10000,
    "财经": 7420
}

test=
{
    "科技": 5000,
    "游戏": 2438,
    "体育": 5000,
    "星座": 358,
    "时政": 5000,
    "教育": 4194,
    "时尚": 1337,
    "彩票": 759,
    "家居": 3259,
    "房产": 2005,
    "股票": 5000,
    "娱乐": 5000,
    "社会": 5000,
    "财经": 3710
}

## 短文本样本量(新闻标题)
类别：财经、房产、股票、教育、科技、社会、时政、体育、游戏、娱乐。

数据集划分：

数据集	数据量
训练集	18万
验证集	1万
测试集	1万

模型	acc	备注
bert	94.83%	单纯的bert
ERNIE	94.61%	说好的中文碾压bert呢
bert_CNN	94.44%	bert + CNN
bert_RNN	94.57%	bert + RNN
bert_RCNN	94.51%	bert + RCNN
bert_DPCNN	94.47%	bert + DPCNN
原始的bert效果就很好了，把bert当作embedding层送入其它模型，效果反而降了，之后会尝试长文本的效果对比。



## baseline
-------------------------------------------------jieba分词
***************************** fattext *********************

模型最优参数：
训练参数：{
    "input": "/data/work/dl_project/data/corpus/thuc_news/train.txt",
    "label": "__label__",
    "epoch": 100,
    "lr": 0.08,
    "lrUpdateRate": 100,
    "minn": 2,
    "maxn": 4,
    "loss": "hs",
    "minCount": 3,
    "wordNgrams": 4,
    "bucket": 2000
}

训练时间:

训练集准确率：
样本数N	336401
精确率P	0.921
召回率R	0.921

验证集准确率：
样本数N	96116
精确率P	0.908
召回率R	0.908

测试集准确率:
样本数N	48060
精确率P	0.905
召回率R	0.905



***************************** textcnn *********************

eval的详细结果:
----结果报告 ---:

              precision    recall  f1-score   support

          娱乐     0.9596    0.9760    0.9677      9993
          财经     0.9373    0.9233    0.9302      7415
          彩票     0.9542    0.9492    0.9517      1516
          房产     0.9577    0.9366    0.9470      4008
          股票     0.9349    0.9414    0.9382      9998
          家居     0.9543    0.9642    0.9592      6513
          教育     0.9575    0.9532    0.9553      8382
          科技     0.9387    0.9243    0.9314      9994
          社会     0.9196    0.9157    0.9176      9997
          时尚     0.9586    0.9529    0.9557      2673
          时政     0.9233    0.9447    0.9339      9994
          体育     0.9852    0.9857    0.9854      9994
          星座     0.9971    0.9636    0.9801       715
          游戏     0.9646    0.9522    0.9584      4872

    accuracy                         0.9476     96064
   macro avg     0.9530    0.9488    0.9509     96064
weighted avg     0.9477    0.9476    0.9476     96064




测试集混淆矩阵:
[[9753    4    1    4    3   11   24   30   65   28   38   21    0   11]
 [   9 6846    2   30  365   23    9   29   52    0   46    2    0    2]
 [   2    1 1439    0    0    1    1    5   22    0    2   42    0    1]
 [   9   31    1 3754   54   44    7    9   61    2   33    3    0    0]
 [   4  280    0   29 9412   17    3  107    8    0  135    2    0    1]
 [  52    8    0   24   16 6280   12   40   28   23   19    7    0    4]
 [  26   17    3    5    5   21 7990   23  165    9  104    6    1    7]
 [  62   35    2   11  110   70   32 9237  172    4  125   15    0  119]
 [  95   47   36   40   10   41  168  122 9154    9  239   24    0   12]
 [  50    0    0    2    3   34    4    9    6 2547   11    2    1    4]
 [  35   32    5   18   86   16   74   62  188   12 9441   20    0    5]
 [  47    2   18    1    1    6   11    4   19    6   24 9851    0    4]
 [   3    0    0    0    1    6    4    1    1   10    0    0  689    0]
 [  17    1    1    2    1   11    6  162   13    7    8    4    0 4639]]







-------------------------------------------------单字符

***************************** fattext(embedding平均) *********************

train的整体性能:
----模型整体 ----
acc_score:	0.8784753909768401
recall:	0.8286734473509428
f1_score:	0.8482603731961572


train的详细结果:
----结果报告 ---:
              precision    recall  f1-score   support

          财经       0.91      0.83      0.87     25968
          彩票       0.95      0.76      0.84      5311
          房产       0.90      0.83      0.87     14035
          股票       0.84      0.88      0.86     35000
          家居       0.78      0.90      0.83     22810
          教育       0.92      0.90      0.91     29355
          科技       0.86      0.83      0.84     35000
          社会       0.86      0.88      0.87     35000
          时尚       0.88      0.77      0.82      9357
          时政       0.86      0.90      0.88     35000
          体育       0.95      0.96      0.96     35000
          星座       0.96      0.36      0.52      2504
          游戏       0.92      0.86      0.89     17061
          娱乐       0.89      0.93      0.91     35000

    accuracy                           0.88    336401
   macro avg       0.89      0.83      0.85    336401
weighted avg       0.88      0.88      0.88    336401


eval的整体性能:
----模型整体 ----
acc_score:	0.880488160139831
recall:	0.8296649926439568
f1_score:	0.8490923668352283

eval的详细结果:
----结果报告 ---:
              precision    recall  f1-score   support

          财经       0.90      0.83      0.87      7420
          彩票       0.95      0.75      0.84      1518
          房产       0.91      0.83      0.87      4010
          股票       0.84      0.88      0.86     10000
          家居       0.77      0.90      0.83      6517
          教育       0.92      0.90      0.91      8387
          科技       0.86      0.83      0.84     10000
          社会       0.86      0.89      0.88     10000
          时尚       0.86      0.77      0.81      2674
          时政       0.86      0.91      0.88     10000
          体育       0.95      0.96      0.96     10000
          星座       0.96      0.36      0.52       716
          游戏       0.92      0.87      0.89      4874
          娱乐       0.90      0.93      0.92     10000

    accuracy                           0.88     96116
   macro avg       0.89      0.83      0.85     96116
weighted avg       0.88      0.88      0.88     96116



test的整体性能:

----模型整体 ----
acc_score:	0.8765501456512692
recall:	0.8250831809077467
f1_score:	0.8460287607328842

test的详细结果:
----结果报告 ---:
              precision    recall  f1-score   support

          财经       0.90      0.82      0.86      3710
          彩票       0.95      0.71      0.81       759
          房产       0.90      0.82      0.86      2005
          股票       0.83      0.87      0.85      5000
          家居       0.78      0.90      0.83      3259
          教育       0.92      0.90      0.91      4194
          科技       0.86      0.82      0.84      5000
          社会       0.85      0.88      0.87      5000
          时尚       0.87      0.75      0.81      1337
          时政       0.86      0.91      0.88      5000
          体育       0.95      0.96      0.96      5000
          星座       0.95      0.39      0.55       358
          游戏       0.93      0.88      0.90      2438
          娱乐       0.89      0.94      0.91      5000

    accuracy                           0.88     48060
   macro avg       0.89      0.83      0.85     48060
weighted avg       0.88      0.88      0.88     48060




***************************** fattext(带ngram的) *********************

模型最优参数:

训练参数：{
    "input": "/data/work/dl_project/data/corpus/thuc_news/single_char.train.txt",
    "label": "__label__",
    "epoch": 100,
    "lr": 0.08,
    "lrUpdateRate": 100,
    "minn": 2,
    "maxn": 5,
    "loss": "hs",
    "minCount": 3,
    "wordNgrams": 4,
    "bucket": 2000
}

训练时间: 3h

训练集准确率：
样本数N	336400
精确率P	0.894
召回率R	0.894

验证集准确率：
样本数N	96116
精确率P	0.888
召回率R	0.888

测试集准确率:
样本数N	48060
精确率P	0.883
召回率R	0.883





***************************** textcnn *********************

filters = [3,4,5]
num_filter = 64
sequence_length = 512


train的整体性能:

----模型整体 ----
acc_score:	0.9505530601870982
recall:	0.9519643063698664
f1_score:	0.9541043084622384

----结果报告 ---:
              precision    recall  f1-score   support

          财经       0.94      0.92      0.93     25968
          彩票       0.96      0.96      0.96      5311
          房产       0.97      0.92      0.94     14035
          股票       0.94      0.94      0.94     35000
          家居       0.95      0.97      0.96     22810
          教育       0.97      0.95      0.96     29355
          科技       0.94      0.93      0.93     35000
          社会       0.93      0.92      0.93     35000
          时尚       0.99      0.94      0.96      9357
          时政       0.92      0.96      0.94     35000
          体育       0.99      0.99      0.99     35000
          星座       0.99      0.98      0.98      2504
          游戏       0.95      0.97      0.96     17061
          娱乐       0.96      0.98      0.97     35000

    accuracy                           0.95    336401
   macro avg       0.96      0.95      0.95    336401
weighted avg       0.95      0.95      0.95    336401


eval的整体性能:

----模型整体 ----
acc_score:	0.9375754296891257
recall:	0.9387079213615092
f1_score:	0.9412171636258496

----结果报告 ---:
              precision    recall  f1-score   support

          财经       0.93      0.90      0.92      7420
          彩票       0.95      0.95      0.95      1518
          房产       0.96      0.91      0.93      4010
          股票       0.92      0.93      0.92     10000
          家居       0.92      0.96      0.94      6517
          教育       0.96      0.94      0.95      8387
          科技       0.93      0.91      0.92     10000
          社会       0.91      0.90      0.91     10000
          时尚       0.97      0.91      0.94      2674
          时政       0.91      0.95      0.93     10000
          体育       0.99      0.98      0.98     10000
          星座       0.98      0.97      0.98       716
          游戏       0.95      0.95      0.95      4874
          娱乐       0.95      0.97      0.96     10000

    accuracy                           0.94     96116
   macro avg       0.94      0.94      0.94     96116
weighted avg       0.94      0.94      0.94     96116



test的整体性能:

----模型整体 ----
acc_score:	0.9367665418227216
recall:	0.9378700447571312
f1_score:	0.9407148145579879

----结果报告 ---:
              precision    recall  f1-score   support

          财经       0.93      0.90      0.91      3710
          彩票       0.96      0.94      0.95       759
          房产       0.96      0.90      0.93      2005
          股票       0.92      0.92      0.92      5000
          家居       0.92      0.96      0.94      3259
          教育       0.96      0.94      0.95      4194
          科技       0.93      0.91      0.92      5000
          社会       0.90      0.91      0.90      5000
          时尚       0.98      0.91      0.94      1337
          时政       0.91      0.95      0.93      5000
          体育       0.98      0.98      0.98      5000
          星座       0.98      0.98      0.98       358
          游戏       0.94      0.97      0.95      2438
          娱乐       0.95      0.97      0.96      5000

    accuracy                           0.94     48060
   macro avg       0.94      0.94      0.94     48060
weighted avg       0.94      0.94      0.94     48060



***************************** textcnn(pytorch) *********************

filters = [2,3,4]
num_filter = 64
sequence_length = 128


train的整体性能:

----模型整体 ----
acc_score:	0.9390489326726139
recall:	0.9381113538008142
f1_score:	0.9406502256178745

train的详细结果:

----结果报告 ---:
              precision    recall  f1-score   support

          财经       0.94      0.91      0.93     25968
          彩票       0.96      0.93      0.95      5311
          房产       0.93      0.89      0.91     14035
          股票       0.93      0.93      0.93     35000
          家居       0.94      0.94      0.94     22810
          教育       0.95      0.95      0.95     29355
          科技       0.94      0.91      0.92     35000
          社会       0.92      0.91      0.92     35000
          时尚       0.94      0.95      0.95      9357
          时政       0.91      0.95      0.93     35000
          体育       0.98      0.98      0.98     35000
          星座       0.98      0.95      0.97      2504
          游戏       0.95      0.95      0.95     17061
          娱乐       0.95      0.96      0.96     35000

    accuracy                           0.94    336401
   macro avg       0.94      0.94      0.94    336401
weighted avg       0.94      0.94      0.94    336401


eval的整体性能:

----模型整体 ----
acc_score:	0.929408215073453
recall:	0.9274866599697213
f1_score:	0.9302347836812527


eval的详细结果:

----结果报告 ---:
              precision    recall  f1-score   support

          财经       0.93      0.90      0.91      7420
          彩票       0.95      0.92      0.94      1518
          房产       0.92      0.87      0.89      4010
          股票       0.92      0.92      0.92     10000
          家居       0.93      0.93      0.93      6517
          教育       0.95      0.94      0.94      8387
          科技       0.92      0.90      0.91     10000
          社会       0.90      0.90      0.90     10000
          时尚       0.93      0.94      0.94      2674
          时政       0.90      0.95      0.92     10000
          体育       0.98      0.98      0.98     10000
          星座       0.97      0.94      0.95       716
          游戏       0.94      0.94      0.94      4874
          娱乐       0.94      0.95      0.95     10000

    accuracy                           0.93     96116
   macro avg       0.93      0.93      0.93     96116
weighted avg       0.93      0.93      0.93     96116


test的整体性能:

----模型整体 ----
acc_score:	0.9281106949646275
recall:	0.9271377079693816
f1_score:	0.9297630108735639

test的详细结果:

----结果报告 ---:
              precision    recall  f1-score   support

          财经       0.93      0.89      0.91      3710
          彩票       0.96      0.91      0.93       759
          房产       0.92      0.87      0.90      2005
          股票       0.91      0.91      0.91      5000
          家居       0.92      0.93      0.93      3259
          教育       0.94      0.94      0.94      4194
          科技       0.93      0.90      0.91      5000
          社会       0.90      0.90      0.90      5000
          时尚       0.93      0.94      0.93      1337
          时政       0.90      0.95      0.92      5000
          体育       0.98      0.98      0.98      5000
          星座       0.97      0.96      0.96       358
          游戏       0.94      0.95      0.94      2438
          娱乐       0.94      0.95      0.95      5000

    accuracy                           0.93     48060
   macro avg       0.93      0.93      0.93     48060
weighted avg       0.93      0.93      0.93     48060



***************************** textrcnn **************************

train的整体性能:

----模型整体 ----
acc_score:	0.9496761305703609
recall:	0.950753362562664
f1_score:	0.95259212210167


train的详细结果:

----结果报告 ---:
              precision    recall  f1-score   support

          财经       0.96      0.88      0.92     25968
          彩票       0.97      0.95      0.96      5311
          房产       0.95      0.92      0.94     14035
          股票       0.93      0.94      0.93     35000
          家居       0.96      0.95      0.96     22810
          教育       0.96      0.97      0.97     29355
          科技       0.93      0.93      0.93     35000
          社会       0.93      0.95      0.94     35000
          时尚       0.96      0.96      0.96      9357
          时政       0.93      0.95      0.94     35000
          体育       0.98      0.99      0.98     35000
          星座       0.98      0.98      0.98      2504
          游戏       0.96      0.95      0.96     17061
          娱乐       0.96      0.98      0.97     35000

    accuracy                           0.95    336401
   macro avg       0.95      0.95      0.95    336401
weighted avg       0.95      0.95      0.95    336401


eval的整体性能:

----模型整体 ----
acc_score:	0.9416642390444879
recall:	0.9421834261389022
f1_score:	0.9445069799811229

eval的详细结果:

----结果报告 ---:
              precision    recall  f1-score   support

          财经       0.96      0.87      0.91      7420
          彩票       0.97      0.95      0.96      1518
          房产       0.95      0.92      0.93      4010
          股票       0.92      0.93      0.92     10000
          家居       0.95      0.95      0.95      6517
          教育       0.96      0.96      0.96      8387
          科技       0.92      0.92      0.92     10000
          社会       0.91      0.94      0.93     10000
          时尚       0.94      0.94      0.94      2674
          时政       0.93      0.94      0.94     10000
          体育       0.98      0.99      0.98     10000
          星座       0.98      0.97      0.98       716
          游戏       0.96      0.94      0.95      4874
          娱乐       0.95      0.97      0.96     10000

    accuracy                           0.94     96116
   macro avg       0.95      0.94      0.94     96116
weighted avg       0.94      0.94      0.94     96116

test的整体性能:

----模型整体 ----
acc_score:	0.9408655846858094
recall:	0.9418343737132285
f1_score:	0.9435773776467367

test的详细结果:

----结果报告 ---:
              precision    recall  f1-score   support

          财经       0.95      0.87      0.91      3710
          彩票       0.97      0.94      0.96       759
          房产       0.95      0.92      0.93      2005
          股票       0.92      0.93      0.92      5000
          家居       0.95      0.94      0.94      3259
          教育       0.96      0.96      0.96      4194
          科技       0.92      0.91      0.92      5000
          社会       0.90      0.94      0.92      5000
          时尚       0.94      0.94      0.94      1337
          时政       0.93      0.94      0.94      5000
          体育       0.98      0.99      0.98      5000
          星座       0.97      0.98      0.97       358
          游戏       0.95      0.95      0.95      2438
          娱乐       0.95      0.97      0.96      5000

    accuracy                           0.94     48060
   macro avg       0.95      0.94      0.94     48060
weighted avg       0.94      0.94      0.94     48060



***************************** bert **************************

train的整体性能:

----模型整体 ----
acc_score:	0.941385429888734
recall:	0.942356389804906
f1_score:	0.9442734249921091

train的详细结果:

----结果报告 ---:
              precision    recall  f1-score   support

          财经       0.95      0.91      0.93     25968
          彩票       0.97      0.94      0.95      5311
          房产       0.92      0.89      0.91     14035
          股票       0.93      0.93      0.93     35000
          家居       0.96      0.93      0.94     22810
          教育       0.96      0.96      0.96     29355
          科技       0.90      0.94      0.92     35000
          社会       0.95      0.90      0.92     35000
          时尚       0.97      0.95      0.96      9357
          时政       0.90      0.96      0.93     35000
          体育       0.97      0.99      0.98     35000
          星座       0.97      0.98      0.97      2504
          游戏       0.95      0.96      0.96     17061
          娱乐       0.97      0.95      0.96     35000

    accuracy                           0.94    336401
   macro avg       0.95      0.94      0.94    336401
weighted avg       0.94      0.94      0.94    336401

eval的整体性能:

----模型整体 ----
acc_score:	0.9653647675725165
recall:	0.966289549628104
f1_score:	0.9683362858821546
eval的详细结果:

----结果报告 ---:
              precision    recall  f1-score   support

          财经       0.97      0.94      0.95      7420
          彩票       0.99      0.96      0.97      1518
          房产       0.96      0.93      0.95      4010
          股票       0.95      0.96      0.96     10000
          家居       0.98      0.97      0.98      6517
          教育       0.98      0.98      0.98      8387
          科技       0.94      0.97      0.95     10000
          社会       0.97      0.93      0.95     10000
          时尚       0.99      0.98      0.98      2674
          时政       0.93      0.98      0.95     10000
          体育       0.98      0.99      0.99     10000
          星座       0.99      0.99      0.99       716
          游戏       0.97      0.97      0.97      4874
          娱乐       0.99      0.98      0.98     10000

    accuracy                           0.97     96116
   macro avg       0.97      0.97      0.97     96116
weighted avg       0.97      0.97      0.97     96116

test的整体性能:

----模型整体 ----
acc_score:	0.9425093632958802
recall:	0.9433466571892769
f1_score:	0.9448725738634604
test的详细结果:

----结果报告 ---:
              precision    recall  f1-score   support

          财经       0.94      0.91      0.92      3710
          彩票       0.97      0.92      0.95       759
          房产       0.92      0.90      0.91      2005
          股票       0.93      0.93      0.93      5000
          家居       0.96      0.93      0.94      3259
          教育       0.96      0.96      0.96      4194
          科技       0.91      0.94      0.92      5000
          社会       0.95      0.90      0.92      5000
          时尚       0.97      0.95      0.96      1337
          时政       0.90      0.96      0.93      5000
          体育       0.97      0.99      0.98      5000
          星座       0.96      0.99      0.97       358
          游戏       0.95      0.97      0.96      2438
          娱乐       0.97      0.95      0.96      5000

    accuracy                           0.94     48060
   macro avg       0.95      0.94      0.94     48060
weighted avg       0.94      0.94      0.94     48060
